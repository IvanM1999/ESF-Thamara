-- CriaÃ§Ã£o da tabela de interaÃ§Ãµes do Chatbot
CREATE TABLE IF NOT EXISTS chatbot_interactions (
    id SERIAL PRIMARY KEY,
    intent_id VARCHAR(50) UNIQUE NOT NULL,
    keys TEXT[] NOT NULL, -- Array de palavras-chave/frases
    response TEXT NOT NULL, -- Resposta em HTML
    options TEXT[] -- Array de botÃµes (opcional)
);

-- InserÃ§Ã£o dos dados iniciais (Baseado na sua inteligÃªncia atual)
INSERT INTO chatbot_interactions (intent_id, keys, response, options) VALUES
('saudacao', ARRAY['ola', 'oi', 'bom dia', 'boa tarde', 'boa noite', 'gostaria de falar com alguem', 'iniciar atendimento', 'oi tudo bem'], 'OlÃ¡! Sou a IA da ESF Thamara. ğŸ¥<br>Posso ajudar com informaÃ§Ãµes administrativas ou fazer uma **prÃ©-triagem** de sintomas.<br>Como posso ajudar?', ARRAY['HorÃ¡rios de Atendimento', 'Estou com dor', 'Vacinas', 'EndereÃ§o']),
('horarios', ARRAY['qual o horario de atendimento', 'que horas o posto abre', 'ate que horas funciona', 'horario de funcionamento', 'estÃ¡ aberto agora', 'agenda da unidade'], 'ğŸ•’ **DinÃ¢mica de Atendimento:**<br>â€¢ **Seg, Ter e Qui:** ManhÃ£ (intercorrÃªncias/agendamentos), Tarde (consultas/enfermagem).<br>â€¢ **Quarta:** ManhÃ£ (intercorrÃªncias), Tarde (visitas domiciliares).<br>â€¢ **Sexta:** ManhÃ£ (intercorrÃªncias), Tarde (formaÃ§Ã£o equipe).<br>ğŸš« **AlmoÃ§o:** 12h Ã s 13h (fechado).<br>âš ï¸ Fora desses horÃ¡rios, procure o AG Garcia ou Hospitais.', ARRAY['Como agendar consulta?', 'Onde fica o AG Garcia?']),
('endereco', ARRAY['qual o endereÃ§o', 'onde fica o posto', 'localizaÃ§Ã£o da unidade', 'como chegar no posto', 'mapa da unidade', 'rua do posto'], 'ğŸ“ **EndereÃ§o:**<br>Rua Santa Maria, 2082 â€“ Bairro Progresso, Blumenau (SC).<br>CEP: 89027-202.', ARRAY['Ver no Mapa', 'HorÃ¡rios']),
('contato', ARRAY['qual o telefone', 'numero para contato', 'como ligar para o posto', 'tem whatsapp', 'numero do zap'], 'ğŸ“ **Telefones:**<br>(47) 3381-7064<br>(47) 3381-6751<br>No momento nÃ£o temos WhatsApp oficial para agendamento.', ARRAY['Voltar ao inÃ­cio']),
('vacinas', ARRAY['horario de vacinacao', 'quero tomar vacina', 'tem vacina da gripe', 'campanha de vacinacao', 'preciso me vacinar'], 'ğŸ’‰ **Sala de Vacinas:**<br>Segunda a Quinta: 09h Ã s 11h30 e 13h Ã s 15h.<br>Sexta: 09h Ã s 11h30 (somente matutino).<br>Lembre-se de trazer a carteirinha de vacinaÃ§Ã£o e o cartÃ£o do SUS!', ARRAY['Quais documentos levar?', 'Tem vacina da gripe?']),
('consultas', ARRAY['como marcar consulta', 'agendar medico', 'preciso de um clinico geral', 'quero marcar uma consulta', 'tem medico hoje'], 'ğŸ‘¨â€âš•ï¸ **Consultas:**<br>O agendamento Ã© feito preferencialmente presencialmente na unidade. Para casos agudos, venha para a triagem (Acolhimento).', ARRAY['Estou com dor aguda', 'Ã‰ apenas rotina']),
('odonto', ARRAY['tem dentista', 'estou com dor de dente', 'agendar dentista', 'atendimento odontologico', 'arrancar dente'], 'ğŸ¦· **Odontologia:**<br>Temos atendimento odontolÃ³gico. Ã‰ necessÃ¡rio passar pela recepÃ§Ã£o para verificar a disponibilidade de agendamento.', ARRAY['Estou com muita dor de dente', 'Quero agendar limpeza']),
('triagem', ARRAY['estou passando mal', 'muita dor', 'emergencia', 'sintomas de dengue', 'febre alta', 'preciso de atendimento urgente'], 'âš ï¸ **Acolhimento/Triagem:**<br>Se vocÃª estÃ¡ se sentindo mal, venha Ã  unidade. A enfermeira farÃ¡ a classificaÃ§Ã£o de risco.<br><br>ğŸš¨ **Em caso de:** Dor no peito forte, falta de ar intensa ou desmaio, **LIGUE 192 (SAMU)**.', ARRAY['Ligar 192', 'Ir para o posto']),
('visitas', ARRAY['visita domiciliar', 'atendimento em casa', 'paciente acamado', 'agente de saude visita', 'medico vai em casa'], 'ğŸ  **Visitas Domiciliares:**<br>Ocorrem geralmente nas quartas-feiras Ã  tarde. SÃ£o destinadas a pacientes acamados ou com dificuldade de locomoÃ§Ã£o. Converse com seu Agente de SaÃºde (ACS) para solicitar.', ARRAY['Como falar com ACS?', 'Voltar']),
('dor_cotovelo_membros', ARRAY['dor no cotovelo', 'dor no braÃ§o', 'machuquei o joelho', 'torci o pÃ©', 'dor na perna', 'dor nas juntas', 'cotovelo doendo'], 'âš ï¸ **Triagem OrtopÃ©dica (Membros):**<br>Para melhor orientaÃ§Ã£o, analise:<br>1. Houve trauma (batida/queda) recente?<br>2. HÃ¡ inchaÃ§o ou deformidade visÃ­vel?<br>3. A dor impede o movimento?<br><br>ğŸ”´ **VÃ¡ ao Pronto Socorro se:** Houver deformidade evidente ou dor insuportÃ¡vel.<br>ğŸŸ¢ **Cuidados em casa:** Se for leve, aplique gelo e repouso.', ARRAY['Onde fica o PS?', 'Vou aplicar gelo', 'Quero ver um mÃ©dico']),
('dor_cabeca', ARRAY['dor de cabeÃ§a', 'enxaqueca', 'cabeÃ§a doendo muito', 'pontada na cabeÃ§a', 'cefaleia'], 'ğŸ§  **Triagem: Dor de CabeÃ§a**<br>Responda mentalmente:<br>â€¢ A dor Ã© a pior da sua vida?<br>â€¢ Tem alteraÃ§Ãµes na visÃ£o ou fala?<br>â€¢ Teve febre junto?<br><br>Se respondeu **SIM** para algo, procure atendimento imediato. Se for uma dor conhecida (enxaqueca comum), tome sua medicaÃ§Ã£o de costume e repouse em local escuro.', ARRAY['Ã‰ uma dor muito forte', 'Ã‰ uma dor comum', 'Preciso de atestado']),
('dor_peito_cardio', ARRAY['dor no peito', 'aperto no coraÃ§Ã£o', 'pontada no peito', 'infarto', 'dor toracica', 'queimaÃ§Ã£o no peito'], 'ğŸš¨ **ATENÃ‡ÃƒO - POSSÃVEL EMERGÃŠNCIA** ğŸš¨<br>Dor no peito pode ser grave. Se a dor for forte, irradiar para o braÃ§o esquerdo ou vier acompanhada de falta de ar/suor frio:<br><br>ğŸ“ **LIGUE 192 (SAMU) IMEDIATAMENTE** ou vÃ¡ Ã  emergÃªncia hospitalar mais prÃ³xima (H. Santa Isabel).<br>NÃ£o espere por agendamento no posto.', ARRAY['Ligar 192', 'Onde fica o Hospital?', 'Ã‰ sÃ³ uma pontada leve']),
('febre', ARRAY['estou com febre', 'meu filho tem febre', 'temperatura alta', 'corpo quente', 'calafrios'], 'ğŸŒ¡ï¸ **Triagem: Febre**<br>â€¢ **Adultos:** Febre acima de 39Â°C ou por mais de 48h requer avaliaÃ§Ã£o.<br>â€¢ **CrianÃ§as:** Se houver manchas na pele, vÃ´mitos ou prostraÃ§Ã£o, venha imediatamente.<br><br>Beba bastante lÃ­quido e monitore a temperatura.', ARRAY['Ã‰ crianÃ§a', 'Ã‰ adulto', 'Tem manchas na pele']),
('identidade', ARRAY['quem Ã© voce', 'voce Ã© um robo', 'falar com atendente humano', 'quem criou esse bot'], 'Eu sou o assistente virtual da ESF Thamara! Fui criado para facilitar o acesso Ã s informaÃ§Ãµes da unidade. ğŸ¤–', ARRAY['O que vocÃª sabe fazer?']),
('agradecimento', ARRAY['obrigado', 'valeu', 'muito obrigado', 'ajudou muito', 'tchau', 'ate logo'], 'Por nada! Cuide-se bem. ğŸ’™', NULL)
ON CONFLICT (intent_id) DO NOTHING;